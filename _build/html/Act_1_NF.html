
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Actividad de Serie de Tiempo. &#8212; Actividad serie de tiempo</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=9a2dae69"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Act_1_NF';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Instrucciones" href="intro.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/uninortelogo.jpeg" class="logo__image only-light" alt="Actividad serie de tiempo - Home"/>
    <script>document.write(`<img src="_static/uninortelogo.jpeg" class="logo__image only-dark" alt="Actividad serie de tiempo - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Instrucciones
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#"><strong>Actividad de Serie de Tiempo</strong>.</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FAct_1_NF.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/Act_1_NF.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Actividad de Serie de Tiempo.</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comportamiento-de-la-serie-de-tiempo"><strong>Comportamiento de la serie de tiempo:</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#busqueda-de-los-mejores-parametros-teniendo-en-cuenta-los-criterios-aic-bic-y-hqic"><strong>Busqueda de los mejores parametros teniendo en cuenta los criterios AIC, BIC y HQIC</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-de-los-supuestos-y-predicciones-modelo-1-aic"><strong>Análisis de los supuestos y predicciones: modelo 1 AIC</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#supuestos"><strong>Supuestos</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#predicciones"><strong>Predicciones</strong>.</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dias"><strong>7 días</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#rolling"><strong>Rolling</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#sin-rolling"><strong>Sin rolling</strong></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1"><strong>14 días</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id2"><strong>Rolling</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id3"><strong>Sin rolling</strong></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id4"><strong>21 días</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id5"><strong>Rolling</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id6"><strong>Sin Rolling</strong></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id7"><strong>28 días</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id8"><strong>Rolling</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id9"><strong>Sin Rolling</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#graficas-de-prediccion-con-rolling"><strong>Gráficas de predicción con rolling</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tablas-de-errores"><strong>Tablas de errores</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#graficos-de-correlacion-observado-vs-predicho"><strong>Gráficos de correlación: observado vs predicho</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-de-los-supuestos-y-predicciones-modelo-2-bic"><strong>Análisis de los supuestos y predicciones: modelo 2 BIC</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id10"><strong>Supuestos</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id11"><strong>Predicciones</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id12"><strong>7 días</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id13"><strong>Rolling</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id14"><strong>Sin Rolling</strong></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id15"><strong>14 días</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id16"><strong>Rolling</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id17"><strong>Sin rolling</strong></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id18"><strong>21 días</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id19"><strong>Rolling</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id20"><strong>Sin rolling</strong></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id21"><strong>28 días</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id22"><strong>Rolling</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id23"><strong>Sin rolling</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id24"><strong>Gráficas de predicción con rolling</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id25"><strong>Tablas de errores</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id26"><strong>Gráficos de correlación: observado vs predicho</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comparacion-entre-modelo-1-y-modelo-2-mediante-los-errores"><strong>Comparación entre modelo 1 y modelo 2 mediante los errores</strong></a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="actividad-de-serie-de-tiempo">
<h1><strong>Actividad de Serie de Tiempo</strong>.<a class="headerlink" href="#actividad-de-serie-de-tiempo" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">yfinance</span> <span class="k">as</span> <span class="nn">yf</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span><span class="o">,</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">from</span> <span class="nn">statsmodels.graphics.tsaplots</span> <span class="kn">import</span> <span class="n">plot_acf</span><span class="p">,</span> <span class="n">plot_pacf</span>
<span class="kn">from</span> <span class="nn">statsmodels.tsa.stattools</span> <span class="kn">import</span> <span class="n">adfuller</span>
<span class="kn">from</span> <span class="nn">statsmodels.graphics.tsaplots</span> <span class="kn">import</span> <span class="n">plot_predict</span> 
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">r2_score</span>
<span class="kn">import</span> <span class="nn">statsmodels.tsa.api</span> <span class="k">as</span> <span class="nn">smtsa</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
</pre></div>
</div>
</div>
</div>
<p>Para esta actividad se tomarán datos historicos de la api de Yahoo finance de la empresa <strong>Microsoft</strong>, se trabajará con los registros desde enero de 2024 hasta julio de 2024.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ticker_symbol</span> <span class="o">=</span> <span class="s1">&#39;MSFT&#39;</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">yf</span><span class="o">.</span><span class="n">download</span><span class="p">(</span><span class="n">ticker_symbol</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="s2">&quot;2024-01-01&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s2">&quot;2024-07-31&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[*********************100%***********************]  1 of 1 completed
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Open</th>
      <th>High</th>
      <th>Low</th>
      <th>Close</th>
      <th>Adj Close</th>
      <th>Volume</th>
    </tr>
    <tr>
      <th>Date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2024-01-02</th>
      <td>373.859985</td>
      <td>375.899994</td>
      <td>366.769989</td>
      <td>370.869995</td>
      <td>368.854095</td>
      <td>25258600</td>
    </tr>
    <tr>
      <th>2024-01-03</th>
      <td>369.010010</td>
      <td>373.260010</td>
      <td>368.510010</td>
      <td>370.600006</td>
      <td>368.585571</td>
      <td>23083500</td>
    </tr>
    <tr>
      <th>2024-01-04</th>
      <td>370.670013</td>
      <td>373.100006</td>
      <td>367.170013</td>
      <td>367.940002</td>
      <td>365.940002</td>
      <td>20901500</td>
    </tr>
    <tr>
      <th>2024-01-05</th>
      <td>368.970001</td>
      <td>372.059998</td>
      <td>366.500000</td>
      <td>367.750000</td>
      <td>365.751038</td>
      <td>20987000</td>
    </tr>
    <tr>
      <th>2024-01-08</th>
      <td>369.299988</td>
      <td>375.200012</td>
      <td>369.010010</td>
      <td>374.690002</td>
      <td>372.653351</td>
      <td>23134000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(145, 6)
</pre></div>
</div>
</div>
</div>
<section id="comportamiento-de-la-serie-de-tiempo">
<h2><strong>Comportamiento de la serie de tiempo:</strong><a class="headerlink" href="#comportamiento-de-la-serie-de-tiempo" title="Link to this heading">#</a></h2>
<p>Analizamos los gráfica de la serie original, su gráfico de autocorrelación y autocorrelación parcial del cierre ajustado del los registros de microsoft en le primer semestre de 2024.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="mi">4</span><span class="p">)})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;text.usetex&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>  <span class="c1"># Desactivar el uso de LaTeX</span>

<span class="n">nlag</span> <span class="o">=</span> <span class="mi">50</span>

<span class="c1"># Serie original</span>
<span class="n">data</span><span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Serie Original&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Date&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d1e7d92c3ad7c74038ab84e93964ea4a33755fbacf41adce4c640d4922c77a48.png" src="_images/d1e7d92c3ad7c74038ab84e93964ea4a33755fbacf41adce4c640d4922c77a48.png" />
</div>
</div>
<p>Al obtener la gráfica de la serie original, podemos ver que hay cierta tendencia de aumento al paso del tiempo, solo con esto no se puede decir si esta serie es estacionaria o no, se debe hacer la prueba analítica correspondiente.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Autocorrelación y autocorrelación parcial</span>
<span class="n">plot_acf</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">],</span> <span class="n">lags</span><span class="o">=</span><span class="n">nlag</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>  <span class="c1"># Autocorrelación</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/d3276019b69db332ce1a4465d9b47336e9d57f3ae2b0479e181417123dba75eb.png" src="_images/d3276019b69db332ce1a4465d9b47336e9d57f3ae2b0479e181417123dba75eb.png" />
</div>
</div>
<p>Si vemos el gráfica de autocorrelación vemos que el dato actual de nuestra serie de tiempo esta muy correlacionado o influenciado con sus observaciones inmediatas del pasado, además vemos que esta correlación va disminuyendo al tomar datos muy distantes en el pasado.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_pacf</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">],</span> <span class="n">lags</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>  <span class="c1"># Autocorrelación Parcial</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/31237ef0631329fdc61ff0f663995c945ccd4d17250b1ed40703842a5fcc9696.png" src="_images/31237ef0631329fdc61ff0f663995c945ccd4d17250b1ed40703842a5fcc9696.png" />
</div>
</div>
<p>Y por ultimo si tomamos en cuenta el gráfico de autocorrelación parcial se puede ver una gran influencia en los primeros os datos inmediatos del pasado y una gran caída al comparar el resto de las observaciones.</p>
<p><strong>Prueba de Duckey-Fuller aumentada</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">adf_result</span> <span class="o">=</span> <span class="n">adfuller</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Adj Close&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ADF Statistic: </span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">adf_result</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;p-value: </span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span><span class="k">adf_result</span>[1])
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>ADF Statistic: -2.522702
p-value: 0.110048
</pre></div>
</div>
</div>
</div>
<p>con un p-valor de 0.11 el cual es mayor al nivel de significancia de 0.05 por tanto no se rechaza la hipotesis nula lo que indica que la serie es no estacionaria, por lo cual se debe implementar un modelo <strong>ARIMA</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">)})</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Original Series&#39;</span><span class="p">)</span>

<span class="n">plot_acf</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">],</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

<span class="n">data_diff</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">diff</span><span class="p">()</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">data_diff</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;1st Order Differencing&#39;</span><span class="p">)</span>

<span class="n">plot_acf</span><span class="p">(</span><span class="n">data_diff</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/7ef0960f487e6c3a570226e0270e6316be16d2772758ad300d2d7109bd4f8183.png" src="_images/7ef0960f487e6c3a570226e0270e6316be16d2772758ad300d2d7109bd4f8183.png" />
</div>
</div>
<p>Con los resultados de la prueba analítica de Duckey-Fuller establecimos que la serie es no estacionaria, por tanto, es importante tener una idea de cuantas diferenciaciones se necesitarán para volver la serie estacionaria, mediante el gráfico anterior podemos ver que este parametro de diferenciación en el modelo ARIMA <span class="math notranslate nohighlight">\(d\)</span> debe ser 1, puesto que con una sola diferenciación la serie ya se mira estacionaria y su autocorrelación demuestra esto mismo.</p>
<p>Con estos preeliminares podemos pasar a buscar cuales son los mejores parametros para nuestro modelo ARIMA, estos se escogeran teniendo en cuenta los criterios de AIC, BIC y HQIC.</p>
</section>
<section id="busqueda-de-los-mejores-parametros-teniendo-en-cuenta-los-criterios-aic-bic-y-hqic">
<h2><strong>Busqueda de los mejores parametros teniendo en cuenta los criterios AIC, BIC y HQIC</strong><a class="headerlink" href="#busqueda-de-los-mejores-parametros-teniendo-en-cuenta-los-criterios-aic-bic-y-hqic" title="Link to this heading">#</a></h2>
<p>Busqueda manueal de los mejores parametros:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model_scores</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">ari</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">maj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="c1"># Ajuste del modelo ARIMA</span>
                <span class="n">arima_obj</span> <span class="o">=</span> <span class="n">smtsa</span><span class="o">.</span><span class="n">ARIMA</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="n">ari</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">maj</span><span class="p">))</span>
                <span class="n">arima_obj_fit</span> <span class="o">=</span> <span class="n">arima_obj</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

                <span class="c1"># Almacenar los valores de AIC, BIC, HQIC y los parámetros</span>
                <span class="n">model_scores</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">ari</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">maj</span><span class="p">,</span> <span class="n">arima_obj_fit</span><span class="o">.</span><span class="n">aic</span><span class="p">,</span> <span class="n">arima_obj_fit</span><span class="o">.</span><span class="n">bic</span><span class="p">,</span> <span class="n">arima_obj_fit</span><span class="o">.</span><span class="n">hqic</span><span class="p">])</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="k">pass</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>c:\Users\fonta\miniconda3\envs\tarea1_venv\lib\site-packages\statsmodels\tsa\statespace\sarimax.py:978: UserWarning: Non-invertible starting MA parameters found. Using zeros as starting parameters.
  warn(&#39;Non-invertible starting MA parameters found.&#39;
</pre></div>
</div>
</div>
</div>
<p>A continuación se muestran las diferentes combinaciones de parametros con sus respectivos puntajes para uno de los criterios de interés.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ar(p)&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;maj(q)&#39;</span><span class="p">,</span> <span class="s1">&#39;AIC&#39;</span><span class="p">,</span> <span class="s1">&#39;BIC&#39;</span><span class="p">,</span> <span class="s1">&#39;HQIC&#39;</span><span class="p">]</span>
<span class="n">model_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">model_scores</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>

<span class="c1"># Encontrar los parámetros que minimizan AIC, BIC y HQIC</span>
<span class="n">best_aic_params</span> <span class="o">=</span> <span class="n">model_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">model_df</span><span class="p">[</span><span class="s1">&#39;AIC&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span>
<span class="n">best_bic_params</span> <span class="o">=</span> <span class="n">model_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">model_df</span><span class="p">[</span><span class="s1">&#39;BIC&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span>
<span class="n">best_hqic_params</span> <span class="o">=</span> <span class="n">model_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">model_df</span><span class="p">[</span><span class="s1">&#39;HQIC&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmin</span><span class="p">()]</span>

<span class="n">model_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>ar(p)</th>
      <th>d</th>
      <th>maj(q)</th>
      <th>AIC</th>
      <th>BIC</th>
      <th>HQIC</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>888.201409</td>
      <td>897.110849</td>
      <td>891.821703</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
      <td>2</td>
      <td>886.925691</td>
      <td>898.804945</td>
      <td>891.752750</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>1</td>
      <td>1</td>
      <td>886.228064</td>
      <td>898.107317</td>
      <td>891.055122</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2</td>
      <td>1</td>
      <td>2</td>
      <td>885.734197</td>
      <td>900.583263</td>
      <td>891.768020</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>2</td>
      <td>1</td>
      <td>888.625652</td>
      <td>897.514186</td>
      <td>892.237527</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1</td>
      <td>2</td>
      <td>2</td>
      <td>889.284328</td>
      <td>901.135706</td>
      <td>894.100160</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2</td>
      <td>2</td>
      <td>1</td>
      <td>886.303076</td>
      <td>898.154455</td>
      <td>891.118909</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2</td>
      <td>2</td>
      <td>2</td>
      <td>887.219015</td>
      <td>902.033239</td>
      <td>893.238806</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Mejores parámetros según AIC:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model_df</span><span class="o">.</span><span class="n">nsmallest</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s2">&quot;AIC&quot;</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Mejores parámetros según BIC:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model_df</span><span class="o">.</span><span class="n">nsmallest</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s2">&quot;BIC&quot;</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Mejores parámetros según HQIC:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model_df</span><span class="o">.</span><span class="n">nsmallest</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s2">&quot;HQIC&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mejores parámetros según AIC:
   ar(p)  d  maj(q)         AIC         BIC       HQIC
3      2  1       2  885.734197  900.583263  891.76802

Mejores parámetros según BIC:
   ar(p)  d  maj(q)         AIC         BIC        HQIC
0      1  1       1  888.201409  897.110849  891.821703

Mejores parámetros según HQIC:
   ar(p)  d  maj(q)         AIC         BIC        HQIC
2      2  1       1  886.228064  898.107317  891.055122
</pre></div>
</div>
</div>
</div>
<p>En primer lugar, se realizó una búsqueda por cada una de las combinaciones de parámetros y se guardó cada uno de los criterios de interés, para así mostrar cuáles eran los parámetros que minimizaban cada uno de los criterios, con este procedimiento encontramos los mejores 3 modelos para cada métrica, si  comparamos de entre los 3 modelos el criterio <strong>HQIC</strong> no cambia en gran manera, por tanto, no causa una diferencia significativa, por tanto, podríamos analizar los 2 últimos modelos los cuales minimizan los criterios de <strong>BIC</strong> y <strong>AIC</strong>.</p>
<p>Los parametros que minimizan el criterio de <strong>AIC</strong> son <span class="math notranslate nohighlight">\(p=2\)</span>, <span class="math notranslate nohighlight">\(d=1\)</span> que lo llamaremos <em><strong>modelo 1</strong></em> y <span class="math notranslate nohighlight">\(q=2\)</span> y los que minimizan el criterio <strong>BIC</strong> son <span class="math notranslate nohighlight">\(p=1\)</span>, <span class="math notranslate nohighlight">\(d=1\)</span> y <span class="math notranslate nohighlight">\(q=1\)</span> que lo llamaremos <em><strong>modelo 2</strong></em>.</p>
</section>
<section id="analisis-de-los-supuestos-y-predicciones-modelo-1-aic">
<h2><strong>Análisis de los supuestos y predicciones: modelo 1 AIC</strong><a class="headerlink" href="#analisis-de-los-supuestos-y-predicciones-modelo-1-aic" title="Link to this heading">#</a></h2>
<p>Como primer paso se analizarán los supuestos del modelo 1 que es el que obtuvo el minimo AIC.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modelo1</span><span class="o">=</span><span class="n">smtsa</span><span class="o">.</span><span class="n">ARIMA</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">)})</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">();</span>
<span class="n">plot_predict</span><span class="p">(</span><span class="n">modelo1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/bdad406fe1bc96b0ed50d78a103d1aee3adfe8c281bad25e12874f8f961ed296.png" src="_images/bdad406fe1bc96b0ed50d78a103d1aee3adfe8c281bad25e12874f8f961ed296.png" />
</div>
</div>
<p>En el gráfico anterior vemos el intervalo en el cual se encontrarían las predicciones del modelo, vemos que el área gris esta bordeando a los valores observados de manera cercana, lo que puede indicar que el modelo puede estar ajustando bien.</p>
<section id="supuestos">
<h3><strong>Supuestos</strong><a class="headerlink" href="#supuestos" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modelo1</span><span class="o">.</span><span class="n">plot_diagnostics</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/819bc7cb8cbe76d48cadd82982b106c1d04e4b3b263dcb3ba6e0f851506af900.png" src="_images/819bc7cb8cbe76d48cadd82982b106c1d04e4b3b263dcb3ba6e0f851506af900.png" />
</div>
</div>
<p>Lo mas importante al momento de revisar los residuos del modelo es poder determinar si son normales o no y si estos son independientes o no, los gráficos anteriores nos muestran que los residuos si se distribuyen normal, esto lo podemos ver en el histograma y en gráfico de Quantil Quantil por el lado de la independencia de los residuos vemos que los residuos no estan correlacionados entre si.</p>
</section>
<section id="predicciones">
<h3><strong>Predicciones</strong>.<a class="headerlink" href="#predicciones" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">arima_rolling</span><span class="p">(</span><span class="n">history</span><span class="p">,</span> <span class="n">test</span><span class="p">,</span> <span class="n">orden</span><span class="p">):</span>
    
    <span class="n">predictions</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">test</span><span class="p">)):</span>
        <span class="n">model</span> <span class="o">=</span> <span class="n">smtsa</span><span class="o">.</span><span class="n">ARIMA</span><span class="p">(</span><span class="n">history</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="n">orden</span><span class="p">)</span>
        <span class="n">model_fit</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
        <span class="n">output</span> <span class="o">=</span> <span class="n">model_fit</span><span class="o">.</span><span class="n">forecast</span><span class="p">()</span>
        <span class="n">yhat</span> <span class="o">=</span> <span class="n">output</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">predictions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">yhat</span><span class="p">)</span>
        <span class="n">obs</span> <span class="o">=</span> <span class="n">test</span><span class="p">[</span><span class="n">t</span><span class="p">]</span>
        <span class="n">history</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;predicted=</span><span class="si">%f</span><span class="s1">, expected=</span><span class="si">%f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">yhat</span><span class="p">,</span> <span class="n">obs</span><span class="p">))</span>
        
    <span class="k">return</span> <span class="n">predictions</span>
</pre></div>
</div>
</div>
</div>
<section id="dias">
<h4><strong>7 días</strong><a class="headerlink" href="#dias" title="Link to this heading">#</a></h4>
<p>Para hacer la predicción para los ultimos 7 días se necesita definir el conjunto de entrenamiento y test, esto se hará a continuación.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">]);</span> <span class="n">n_test</span> <span class="o">=</span> <span class="mi">7</span>
<span class="n">train_size</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="n">n_test</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Tamaño de la muestra de entrenamiento&#39;</span><span class="p">,</span> <span class="n">train_size</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Tamaño de la muestra de test&#39;</span><span class="p">,</span> <span class="n">n_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Tamaño de la muestra de entrenamiento 138
Tamaño de la muestra de test 7
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_df7</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="s2">&quot;Adj Close&quot;</span><span class="p">]][:</span><span class="n">train_size</span><span class="p">]</span>
<span class="n">test_df7</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="s2">&quot;Adj Close&quot;</span><span class="p">]][</span><span class="n">train_size</span><span class="p">:</span><span class="n">train_size</span> <span class="o">+</span> <span class="n">n_test</span><span class="p">]</span> 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dates_train7</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">[:</span><span class="n">train_size</span><span class="p">]</span>
<span class="n">dates_test7</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">train_size</span><span class="p">:</span><span class="n">train_size</span> <span class="o">+</span> <span class="n">n_test</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<section id="rolling">
<h5><strong>Rolling</strong><a class="headerlink" href="#rolling" title="Link to this heading">#</a></h5>
<p>Primeramente se hará la predicción usando rolling.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_final7</span> <span class="o">=</span> <span class="n">test_df7</span><span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">predic_7</span>  <span class="o">=</span> <span class="n">arima_rolling</span><span class="p">(</span><span class="n">train_df7</span><span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">test_final7</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>predicted=436.753376, expected=442.143066
predicted=441.610326, expected=444.049652
predicted=444.408723, expected=428.128326
predicted=429.249566, expected=417.647217
predicted=418.545875, expected=424.504852
predicted=424.798157, expected=425.962250
predicted=425.144586, expected=422.159119
</pre></div>
</div>
</div>
</div>
<p>Vemos que la diferencia entre lo observado y lo predicho no es mucha lo que quiere decir que la predicción parece estar funcionando bien.</p>
</section>
<section id="sin-rolling">
<h5><strong>Sin rolling</strong><a class="headerlink" href="#sin-rolling" title="Link to this heading">#</a></h5>
<p>Ahora veamos las mismas predicciónes pero sin utilizar el rolling.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modelo1</span><span class="o">=</span><span class="n">smtsa</span><span class="o">.</span><span class="n">ARIMA</span><span class="p">(</span><span class="n">train_df7</span><span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">forecast_steps</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_df7</span><span class="p">)</span>
<span class="n">forecast_7</span> <span class="o">=</span> <span class="n">modelo1</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">forecast_steps</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">test_df7</span><span class="p">)):</span>
    <span class="n">observado</span> <span class="o">=</span> <span class="n">test_df7</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">]</span> 
    <span class="n">predicho_7</span> <span class="o">=</span> <span class="n">forecast_7</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;observado: </span><span class="si">{</span><span class="n">observado</span><span class="si">}</span><span class="s1">, predicho: </span><span class="si">{</span><span class="n">predicho_7</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>observado: 442.14306640625, predicho: 436.75337597708096
observado: 444.0496520996094, predicho: 436.0421349266471
observado: 428.1283264160156, predicho: 436.75785653230463
observado: 417.647216796875, predicho: 436.27517368579663
observado: 424.5048522949219, predicho: 436.39949441985107
observado: 425.9622497558594, predicho: 436.6217575551293
observado: 422.15911865234375, predicho: 436.17764635767463
</pre></div>
</div>
</div>
</div>
<p>Al hacer las predicciones sin el rolling vemos que hay un pequeño problema, puesto que el valor que esta prediciendo esta siempre cercano a 436 lo que quiere decir que no se esta capturando bien la varianza de los datos y esto ocurre por como se estan haciendo las predicciones.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predicciones_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Fecha&#39;</span><span class="p">:</span> <span class="n">test_df7</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
    <span class="s1">&#39;Predicho&#39;</span><span class="p">:</span> <span class="n">forecast_7</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">test_df7</span><span class="p">)]</span>
<span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">train_df7</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">train_df7</span><span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Train&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test_df7</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">test_df7</span><span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Test (Últimos 7 días)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">predicciones_df</span><span class="p">[</span><span class="s1">&#39;Fecha&#39;</span><span class="p">],</span> <span class="n">predicciones_df</span><span class="p">[</span><span class="s1">&#39;Predicho&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Predicciones&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/24fced12525c1ac67662c9139fbc3355b71d7998e09d71b7d47036e43e9e9983.png" src="_images/24fced12525c1ac67662c9139fbc3355b71d7998e09d71b7d47036e43e9e9983.png" />
</div>
</div>
<p>Mediante esta gráfica podemos ver como esta prediciendo el modelo y confirmamos lo dicho anteriormente, donde no se esta capturando bien la variabilidad de los datos, mas adelante veremos que esto no ocurre cuando se usa el rolling.</p>
</section>
</section>
<section id="id1">
<h4><strong>14 días</strong><a class="headerlink" href="#id1" title="Link to this heading">#</a></h4>
<p>Para encargarnos de hacer las predicciones para el horizonte de 14 días debemos separar de nuevo los conjunto de entrenamiento y test.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">]);</span> <span class="n">n_test</span> <span class="o">=</span> <span class="mi">14</span>
<span class="n">train_size</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="n">n_test</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Tamaño de la muestra de entrenamiento&#39;</span><span class="p">,</span> <span class="n">train_size</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Tamaño de la muestra de test&#39;</span><span class="p">,</span> <span class="n">n_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Tamaño de la muestra de entrenamiento 131
Tamaño de la muestra de test 14
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_df14</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="s2">&quot;Adj Close&quot;</span><span class="p">]][:</span><span class="n">train_size</span><span class="p">]</span>
<span class="n">test_df14</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="s2">&quot;Adj Close&quot;</span><span class="p">]][</span><span class="n">train_size</span><span class="p">:</span><span class="n">train_size</span> <span class="o">+</span> <span class="n">n_test</span><span class="p">]</span> 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dates_train14</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">[:</span><span class="n">train_size</span><span class="p">]</span>
<span class="n">dates_test14</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">train_size</span><span class="p">:</span><span class="n">train_size</span> <span class="o">+</span> <span class="n">n_test</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<section id="id2">
<h5><strong>Rolling</strong><a class="headerlink" href="#id2" title="Link to this heading">#</a></h5>
<p>Como en el caso anterior, se harán primero las predicciones usando el rolling.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_final14</span> <span class="o">=</span> <span class="n">test_df14</span><span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">predic_14</span>  <span class="o">=</span> <span class="n">arima_rolling</span><span class="p">(</span><span class="n">train_df14</span><span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">test_final14</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>predicted=465.616129, expected=453.881927
predicted=453.442597, expected=452.733978
predicted=454.373398, expected=453.143250
predicted=451.062743, expected=448.711243
predicted=450.467532, expected=442.722015
predicted=441.877775, expected=439.577698
predicted=439.669304, expected=436.323547
predicted=436.753376, expected=442.143066
predicted=441.610326, expected=444.049652
predicted=444.408723, expected=428.128326
predicted=429.249566, expected=417.647217
predicted=418.545875, expected=424.504852
predicted=424.798157, expected=425.962250
predicted=425.144586, expected=422.159119
</pre></div>
</div>
</div>
</div>
</section>
<section id="id3">
<h5><strong>Sin rolling</strong><a class="headerlink" href="#id3" title="Link to this heading">#</a></h5>
<p>Y ahora se harán las predicciones sin usar el rolling para predecir los ultimos 14 días.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modelo1</span><span class="o">=</span><span class="n">smtsa</span><span class="o">.</span><span class="n">ARIMA</span><span class="p">(</span><span class="n">train_df14</span><span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">forecast_steps</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_df14</span><span class="p">)</span>
<span class="n">forecast_14</span> <span class="o">=</span> <span class="n">modelo1</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">forecast_steps</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">test_df14</span><span class="p">)):</span>
    <span class="n">observado</span> <span class="o">=</span> <span class="n">test_df14</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">]</span>  <span class="c1"># Valores observados</span>
    <span class="n">predicho_14</span> <span class="o">=</span> <span class="n">forecast_14</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>  <span class="c1"># Predicciones ya alineadas con el test set</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;observado: </span><span class="si">{</span><span class="n">observado</span><span class="si">}</span><span class="s1">, predicho: </span><span class="si">{</span><span class="n">predicho_14</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>observado: 453.8819274902344, predicho: 465.61612880846985
observado: 452.7339782714844, predicho: 465.27813972989344
observado: 453.14324951171875, predicho: 465.6396623132482
observado: 448.71124267578125, predicho: 465.3538970861588
observado: 442.7220153808594, predicho: 465.4995603600402
observado: 439.57769775390625, predicho: 465.5115897252685
observado: 436.32354736328125, predicho: 465.3686844873118
observado: 442.14306640625, predicho: 465.58499938942975
observado: 444.0496520996094, predicho: 465.3635753203669
observado: 428.1283264160156, predicho: 465.5306895316434
observado: 417.647216796875, predicho: 465.4540140106438
observado: 424.5048522949219, predicho: 465.43349238979346
observado: 425.9622497558594, predicho: 465.53121012478755
observado: 422.15911865234375, predicho: 465.39374875938705
</pre></div>
</div>
</div>
</div>
<p>Vemos que el comportamiento de esta predicción es igual a la anterior, el modelo parece no captar de una buena manera la variabilidad de los datos, todos los valores estan cerca de 465, veremos este comportamiento gráficamente. Adémas vemos que los errores son mucho mas grandes y significativos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predicciones_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Fecha&#39;</span><span class="p">:</span> <span class="n">test_df14</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
    <span class="s1">&#39;Predicho&#39;</span><span class="p">:</span> <span class="n">forecast_14</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">test_df14</span><span class="p">)]</span>
<span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">train_df14</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">train_df14</span><span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Train&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test_df14</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">test_df14</span><span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Test (Últimos 14 días)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">predicciones_df</span><span class="p">[</span><span class="s1">&#39;Fecha&#39;</span><span class="p">],</span> <span class="n">predicciones_df</span><span class="p">[</span><span class="s1">&#39;Predicho&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Predicciones&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/c1e07339efdbee18c52e8d7c3d6ccfee097b8b704c6879c8b5835669e352f74d.png" src="_images/c1e07339efdbee18c52e8d7c3d6ccfee097b8b704c6879c8b5835669e352f74d.png" />
</div>
</div>
<p>Vemos que el modelo no esta ajustando nada en el conjunto del test, esto se verá en las tablas de error que se presentarán mas adelante.</p>
</section>
</section>
<section id="id4">
<h4><strong>21 días</strong><a class="headerlink" href="#id4" title="Link to this heading">#</a></h4>
<p>Pasemos a hacer la predicción para el horizonre de 21 días siguiendo los mismos pasos utilizados anteriormente.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">]);</span> <span class="n">n_test</span> <span class="o">=</span> <span class="mi">21</span>
<span class="n">train_size</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="n">n_test</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Tamaño de la muestra de entrenamiento&#39;</span><span class="p">,</span> <span class="n">train_size</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Tamaño de la muestra de test&#39;</span><span class="p">,</span> <span class="n">n_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Tamaño de la muestra de entrenamiento 124
Tamaño de la muestra de test 21
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_df21</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="s2">&quot;Adj Close&quot;</span><span class="p">]][:</span><span class="n">train_size</span><span class="p">]</span>
<span class="n">test_df21</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="s2">&quot;Adj Close&quot;</span><span class="p">]][</span><span class="n">train_size</span><span class="p">:</span><span class="n">train_size</span> <span class="o">+</span> <span class="n">n_test</span><span class="p">]</span> 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dates_train21</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">[:</span><span class="n">train_size</span><span class="p">]</span>
<span class="n">dates_test21</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">train_size</span><span class="p">:</span><span class="n">train_size</span> <span class="o">+</span> <span class="n">n_test</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<section id="id5">
<h5><strong>Rolling</strong><a class="headerlink" href="#id5" title="Link to this heading">#</a></h5>
<p>Rolling para predecir los ultimos 21 días.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_final21</span> <span class="o">=</span> <span class="n">test_df21</span><span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">predic_21</span>  <span class="o">=</span> <span class="n">arima_rolling</span><span class="p">(</span><span class="n">train_df21</span><span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">test_final21</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>predicted=446.024450, expected=455.908264
predicted=456.485008, expected=458.453674
predicted=456.490286, expected=459.940979
predicted=460.482912, expected=466.718781
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>c:\Users\fonta\miniconda3\envs\tarea1_venv\lib\site-packages\statsmodels\base\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals
  warnings.warn(&quot;Maximum Likelihood optimization failed to &quot;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>predicted=465.764440, expected=465.401154
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>c:\Users\fonta\miniconda3\envs\tarea1_venv\lib\site-packages\statsmodels\base\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals
  warnings.warn(&quot;Maximum Likelihood optimization failed to &quot;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>predicted=466.080622, expected=458.713226
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>c:\Users\fonta\miniconda3\envs\tarea1_venv\lib\site-packages\statsmodels\base\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals
  warnings.warn(&quot;Maximum Likelihood optimization failed to &quot;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>predicted=457.884010, expected=465.411133
predicted=465.616129, expected=453.881927
predicted=453.442597, expected=452.733978
predicted=454.373398, expected=453.143250
predicted=451.062743, expected=448.711243
predicted=450.467532, expected=442.722015
predicted=441.877775, expected=439.577698
predicted=439.669304, expected=436.323547
predicted=436.753376, expected=442.143066
predicted=441.610326, expected=444.049652
predicted=444.408723, expected=428.128326
predicted=429.249566, expected=417.647217
predicted=418.545875, expected=424.504852
predicted=424.798157, expected=425.962250
predicted=425.144586, expected=422.159119
</pre></div>
</div>
</div>
</div>
</section>
<section id="id6">
<h5><strong>Sin Rolling</strong><a class="headerlink" href="#id6" title="Link to this heading">#</a></h5>
<p>Predicciones para los ultimos 21 días sin usar el rolling.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modelo1</span><span class="o">=</span><span class="n">smtsa</span><span class="o">.</span><span class="n">ARIMA</span><span class="p">(</span><span class="n">train_df21</span><span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">forecast_steps</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_df21</span><span class="p">)</span>
<span class="n">forecast_21</span> <span class="o">=</span> <span class="n">modelo1</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">forecast_steps</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">test_df21</span><span class="p">)):</span>
    <span class="n">observado</span> <span class="o">=</span> <span class="n">test_df21</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">]</span>  <span class="c1"># Valores observados</span>
    <span class="n">predicho_21</span> <span class="o">=</span> <span class="n">forecast_21</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>  <span class="c1"># Predicciones ya alineadas con el test set</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;observado: </span><span class="si">{</span><span class="n">observado</span><span class="si">}</span><span class="s1">, predicho: </span><span class="si">{</span><span class="n">predicho_21</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>observado: 455.90826416015625, predicho: 446.0244504062709
observado: 458.45367431640625, predicho: 446.947646833971
observado: 459.94097900390625, predicho: 446.4145749752134
observado: 466.7187805175781, predicho: 446.52824777093633
observado: 465.4011535644531, predicho: 446.580517888722
observado: 458.7132263183594, predicho: 446.5229034751384
observado: 465.4111328125, predicho: 446.5460006856757
observado: 453.8819274902344, predicho: 446.54508369908626
observado: 452.7339782714844, predicho: 446.54038447779783
observado: 453.14324951171875, predicho: 446.543447227743
observado: 448.71124267578125, predicho: 446.54265645080096
observado: 442.7220153808594, predicho: 446.54243975000054
observado: 439.57769775390625, predicho: 446.54275131775756
observado: 436.32354736328125, predicho: 446.54261140078586
observado: 442.14306640625, predicho: 446.54262547701586
observado: 444.0496520996094, predicho: 446.5426487682393
observado: 428.1283264160156, predicho: 446.5426314190232
observado: 417.647216796875, predicho: 446.542636655774
observado: 424.5048522949219, predicho: 446.5426374233328
observado: 425.9622497558594, predicho: 446.54263576544605
observado: 422.15911865234375, predicho: 446.5426365976937
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predicciones_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Fecha&#39;</span><span class="p">:</span> <span class="n">test_df21</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
    <span class="s1">&#39;Predicho&#39;</span><span class="p">:</span> <span class="n">forecast_21</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">test_df21</span><span class="p">)]</span>
<span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">train_df21</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">train_df21</span><span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Train&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test_df21</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">test_df21</span><span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Test (Últimos 21 días)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">predicciones_df</span><span class="p">[</span><span class="s1">&#39;Fecha&#39;</span><span class="p">],</span> <span class="n">predicciones_df</span><span class="p">[</span><span class="s1">&#39;Predicho&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Predicciones&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/94e03757c57cf5c0ce5806892c0702d144a486eba69e8cc88020178a357e2743.png" src="_images/94e03757c57cf5c0ce5806892c0702d144a486eba69e8cc88020178a357e2743.png" />
</div>
</div>
<p>Como era de esperarse, vemos que de igual forma que las predicciones anteriores el modelo no está prediciendo de la mejor manera los datos del test al momento de no usar rolling, las predicciones siempre estan al rededor de 446 y con diferencias significativas entre lo observado y predicho.</p>
</section>
</section>
<section id="id7">
<h4><strong>28 días</strong><a class="headerlink" href="#id7" title="Link to this heading">#</a></h4>
<p>Este es el último horizonte de predicción, se dividirá de igual manera el conjunto de entrenamiento y test.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">]);</span> <span class="n">n_test</span> <span class="o">=</span> <span class="mi">28</span>
<span class="n">train_size</span> <span class="o">=</span> <span class="n">n</span> <span class="o">-</span> <span class="n">n_test</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Tamaño de la muestra de entrenamiento&#39;</span><span class="p">,</span> <span class="n">train_size</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Tamaño de la muestra de test&#39;</span><span class="p">,</span> <span class="n">n_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Tamaño de la muestra de entrenamiento 117
Tamaño de la muestra de test 28
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">train_df28</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="s2">&quot;Adj Close&quot;</span><span class="p">]][:</span><span class="n">train_size</span><span class="p">]</span>
<span class="n">test_df28</span> <span class="o">=</span> <span class="n">data</span><span class="p">[[</span><span class="s2">&quot;Adj Close&quot;</span><span class="p">]][</span><span class="n">train_size</span><span class="p">:</span><span class="n">train_size</span> <span class="o">+</span> <span class="n">n_test</span><span class="p">]</span> 
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dates_train28</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">[:</span><span class="n">train_size</span><span class="p">]</span>
<span class="n">dates_test28</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="n">train_size</span><span class="p">:</span><span class="n">train_size</span> <span class="o">+</span> <span class="n">n_test</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<section id="id8">
<h5><strong>Rolling</strong><a class="headerlink" href="#id8" title="Link to this heading">#</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">test_final28</span> <span class="o">=</span> <span class="n">test_df28</span><span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">predic_28</span>  <span class="o">=</span> <span class="n">arima_rolling</span><span class="p">(</span><span class="n">train_df28</span><span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">test_final28</span><span class="p">,(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>predicted=444.911769, expected=444.898132
predicted=445.607326, expected=448.970764
predicted=448.443134, expected=446.864594
predicted=447.286841, expected=450.138672
predicted=450.222666, expected=451.346497
predicted=450.812507, expected=452.035248
predicted=452.759397, expected=446.145874
predicted=446.024450, expected=455.908264
predicted=456.485008, expected=458.453674
predicted=456.490286, expected=459.940979
predicted=460.482912, expected=466.718781
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>c:\Users\fonta\miniconda3\envs\tarea1_venv\lib\site-packages\statsmodels\base\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals
  warnings.warn(&quot;Maximum Likelihood optimization failed to &quot;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>predicted=465.764440, expected=465.401154
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>c:\Users\fonta\miniconda3\envs\tarea1_venv\lib\site-packages\statsmodels\base\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals
  warnings.warn(&quot;Maximum Likelihood optimization failed to &quot;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>predicted=466.080622, expected=458.713226
</pre></div>
</div>
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>c:\Users\fonta\miniconda3\envs\tarea1_venv\lib\site-packages\statsmodels\base\model.py:607: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals
  warnings.warn(&quot;Maximum Likelihood optimization failed to &quot;
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>predicted=457.884010, expected=465.411133
predicted=465.616129, expected=453.881927
predicted=453.442597, expected=452.733978
predicted=454.373398, expected=453.143250
predicted=451.062743, expected=448.711243
predicted=450.467532, expected=442.722015
predicted=441.877775, expected=439.577698
predicted=439.669304, expected=436.323547
predicted=436.753376, expected=442.143066
predicted=441.610326, expected=444.049652
predicted=444.408723, expected=428.128326
predicted=429.249566, expected=417.647217
predicted=418.545875, expected=424.504852
predicted=424.798157, expected=425.962250
predicted=425.144586, expected=422.159119
</pre></div>
</div>
</div>
</div>
</section>
<section id="id9">
<h5><strong>Sin Rolling</strong><a class="headerlink" href="#id9" title="Link to this heading">#</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modelo1</span><span class="o">=</span><span class="n">smtsa</span><span class="o">.</span><span class="n">ARIMA</span><span class="p">(</span><span class="n">train_df28</span><span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">forecast_steps</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_df28</span><span class="p">)</span>
<span class="n">forecast_28</span> <span class="o">=</span> <span class="n">modelo1</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">forecast_steps</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">test_df28</span><span class="p">)):</span>
    <span class="n">observado</span> <span class="o">=</span> <span class="n">test_df28</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">]</span>  <span class="c1"># Valores observados</span>
    <span class="n">predicho_28</span> <span class="o">=</span> <span class="n">forecast_28</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>  <span class="c1"># Predicciones ya alineadas con el test set</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;observado: </span><span class="si">{</span><span class="n">observado</span><span class="si">}</span><span class="s1">, predicho: </span><span class="si">{</span><span class="n">predicho_28</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>observado: 444.89813232421875, predicho: 444.9117694262907
observado: 448.97076416015625, predicho: 445.620264761318
observado: 446.8645935058594, predicho: 445.3265104806404
observado: 450.138671875, predicho: 445.34863539940915
observado: 451.34649658203125, predicho: 445.40029858468216
observado: 452.0352478027344, predicho: 445.3638563324359
observado: 446.1458740234375, predicho: 445.37463862523174
observado: 455.90826416015625, predicho: 445.3761418778194
observado: 458.45367431640625, predicho: 445.3728323387312
observado: 459.94097900390625, predicho: 445.374518913827
observado: 466.7187805175781, predicho: 445.3742236712287
observado: 465.4011535644531, predicho: 445.3740297231914
observado: 458.7132263183594, predicho: 445.3742136022874
observado: 465.4111328125, predicho: 445.37414439316996
observado: 453.8819274902344, predicho: 445.37414584422726
observado: 452.7339782714844, predicho: 445.3741603121828
observado: 453.14324951171875, predicho: 445.37415115938194
observado: 448.71124267578125, predicho: 445.37415353639847
observado: 442.7220153808594, predicho: 445.37415411602115
observado: 439.57769775390625, predicho: 445.3741532349059
observado: 436.32354736328125, predicho: 445.3741536441315
observado: 442.14306640625, predicho: 445.3741535898204
observado: 444.0496520996094, predicho: 445.37415353218626
observado: 428.1283264160156, predicho: 445.37415357941336
observado: 417.647216796875, predicho: 445.3741535633729
observado: 424.5048522949219, predicho: 445.37415356268656
observado: 425.9622497558594, predicho: 445.37415356666395
observado: 422.15911865234375, predicho: 445.3741535643885
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predicciones_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Fecha&#39;</span><span class="p">:</span> <span class="n">test_df28</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
    <span class="s1">&#39;Predicho&#39;</span><span class="p">:</span> <span class="n">forecast_28</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">test_df28</span><span class="p">)]</span>
<span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">train_df28</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">train_df28</span><span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Train&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test_df28</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">test_df28</span><span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Test (Últimos 21 días)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">predicciones_df</span><span class="p">[</span><span class="s1">&#39;Fecha&#39;</span><span class="p">],</span> <span class="n">predicciones_df</span><span class="p">[</span><span class="s1">&#39;Predicho&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Predicciones&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/f21b65bb0489668831149e94326364085003e1814be9cedd180595df53e8c623.png" src="_images/f21b65bb0489668831149e94326364085003e1814be9cedd180595df53e8c623.png" />
</div>
</div>
<p>Vemos que el mismo comportamiento de las predicciones anteriores se presenta en esta, el error en el conjunto de test es bastante grande, problema que ocuerre al hacer la predicción sin el rolling.</p>
</section>
</section>
</section>
<section id="graficas-de-prediccion-con-rolling">
<h3><strong>Gráficas de predicción con rolling</strong><a class="headerlink" href="#graficas-de-prediccion-con-rolling" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="c1"># Gráfica para horizonte de 7 días</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_train7</span><span class="p">[</span><span class="o">-</span><span class="mi">50</span><span class="p">:],</span> <span class="n">y</span><span class="o">=</span><span class="n">train_df7</span><span class="p">[</span><span class="o">-</span><span class="mi">50</span><span class="p">:][</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Train&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_test7</span><span class="p">[:</span><span class="mi">7</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">test_final7</span><span class="p">[:</span><span class="mi">7</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Test&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_test7</span><span class="p">[:</span><span class="mi">7</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">predic_7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Forecast&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Predicción de 7 días&quot;</span><span class="p">)</span>

<span class="c1"># Gráfica para horizonte de 14 días</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_train14</span><span class="p">[</span><span class="o">-</span><span class="mi">50</span><span class="p">:],</span> <span class="n">y</span><span class="o">=</span><span class="n">train_df14</span><span class="p">[</span><span class="o">-</span><span class="mi">50</span><span class="p">:][</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Train&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_test14</span><span class="p">[:</span><span class="mi">14</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">test_final14</span><span class="p">[:</span><span class="mi">14</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Test&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_test14</span><span class="p">[:</span><span class="mi">14</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">predic_14</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Forecast&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Predicción de 14 días&quot;</span><span class="p">)</span>

<span class="c1"># Gráfica para horizonte de 21 días</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_train21</span><span class="p">[</span><span class="o">-</span><span class="mi">50</span><span class="p">:],</span> <span class="n">y</span><span class="o">=</span><span class="n">train_df21</span><span class="p">[</span><span class="o">-</span><span class="mi">50</span><span class="p">:][</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Train&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_test21</span><span class="p">[:</span><span class="mi">21</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">test_final21</span><span class="p">[:</span><span class="mi">21</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Test&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_test21</span><span class="p">[:</span><span class="mi">21</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">predic_21</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Forecast&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Predicción de 21 días&quot;</span><span class="p">)</span>

<span class="c1"># Gráfica para horizonte de 28 días</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_train28</span><span class="p">[</span><span class="o">-</span><span class="mi">50</span><span class="p">:],</span> <span class="n">y</span><span class="o">=</span><span class="n">train_df28</span><span class="p">[</span><span class="o">-</span><span class="mi">50</span><span class="p">:][</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Train&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_test28</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">test_final28</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Test&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_test28</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">predic_28</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Forecast&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Predicción de 28 días&quot;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Predicciones usando rolling ARIMA (2,1,2)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

<span class="c1"># Ajustar la presentación</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">rect</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/6309921e32bfa55f0daea4b9e52ef8af29f631d260da59e159f663bbca70b90d.png" src="_images/6309921e32bfa55f0daea4b9e52ef8af29f631d260da59e159f663bbca70b90d.png" />
</div>
</div>
<p>Esta última gráfica muestra las predicciones de cada uno de los horizontes establecidos para este ejercicio usando el método de rolling, vemos que a diferencia de lo que se notó en las gráficas de las predicciones sin el uso del rolling estas predicciones siguen de mejor forma la variabilidad de los datos del test, es por esto que se esperaría que los errores de las predicciones con rolling sean menores que los errores al no implementar el rolling.</p>
</section>
<section id="tablas-de-errores">
<h3><strong>Tablas de errores</strong><a class="headerlink" href="#tablas-de-errores" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">forecast_accuracy</span><span class="p">(</span><span class="n">forecast</span><span class="p">,</span> <span class="n">actual</span><span class="p">,</span> <span class="n">str_name</span><span class="p">):</span>
    
    <span class="n">mape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">forecast</span> <span class="o">-</span> <span class="n">actual</span><span class="p">)</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">actual</span><span class="p">))</span> 
    <span class="n">mae</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">forecast</span> <span class="o">-</span> <span class="n">actual</span><span class="p">))</span>                 
    <span class="n">rmse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">forecast</span> <span class="o">-</span> <span class="n">actual</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">**</span><span class="mf">.5</span>               
    <span class="n">mse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">forecast</span> <span class="o">-</span> <span class="n">actual</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>                    
    <span class="n">r2</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">forecast</span><span class="p">,</span> <span class="n">actual</span><span class="p">)</span>
    
    <span class="n">df_acc</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;MAE&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">mae</span><span class="p">],</span>
                           <span class="s1">&#39;MSE&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">mse</span><span class="p">],</span>
                           <span class="s1">&#39;MAPE&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">mape</span><span class="p">],</span>
                           <span class="s1">&#39;RMSE&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">rmse</span><span class="p">],</span>
                           <span class="s1">&#39;R2&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">r2</span><span class="p">]},</span>
                          <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="n">str_name</span><span class="p">])</span>
    
    <span class="k">return</span> <span class="n">df_acc</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Errores de predicción sin rolling</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d7</span><span class="o">=</span><span class="n">forecast_accuracy</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">test_df7</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">forecast_7</span><span class="p">),</span> <span class="s2">&quot; 7 días&quot;</span><span class="p">)</span>
<span class="n">d14</span><span class="o">=</span><span class="n">forecast_accuracy</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">test_df14</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">forecast_14</span><span class="p">),</span> <span class="s2">&quot; 14 días &quot;</span><span class="p">)</span>
<span class="n">d21</span><span class="o">=</span><span class="n">forecast_accuracy</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">test_df21</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">forecast_21</span><span class="p">),</span> <span class="s2">&quot; 21 días&quot;</span><span class="p">)</span>
<span class="n">d28</span><span class="o">=</span><span class="n">forecast_accuracy</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">test_df28</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">forecast_28</span><span class="p">),</span> <span class="s2">&quot; 28 días&quot;</span><span class="p">)</span>

<span class="n">errores_sin</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">d7</span><span class="p">,</span> <span class="n">d14</span><span class="p">,</span> <span class="n">d21</span><span class="p">,</span> <span class="n">d28</span><span class="p">])</span>
<span class="n">errores_sin</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MAE</th>
      <th>MSE</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7 días</th>
      <td>11.012633</td>
      <td>138.369859</td>
      <td>0.025233</td>
      <td>11.763072</td>
      <td>-0.597802</td>
    </tr>
    <tr>
      <th>14 días</th>
      <td>27.490804</td>
      <td>897.496157</td>
      <td>0.059060</td>
      <td>29.958240</td>
      <td>-5.330216</td>
    </tr>
    <tr>
      <th>21 días</th>
      <td>12.822302</td>
      <td>223.212533</td>
      <td>0.028715</td>
      <td>14.940299</td>
      <td>-0.003073</td>
    </tr>
    <tr>
      <th>28 días</th>
      <td>10.507741</td>
      <td>171.436241</td>
      <td>0.023594</td>
      <td>13.093366</td>
      <td>-0.007390</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>En la tabla anterior se presentan las métricas de error para las predicciones del modelo que se hicieron sin usar el método de Rolling, vemos que el comportamiento era lo que esperábamos al ver las gráficas de cada uno de los horizontes, el <span class="math notranslate nohighlight">\(R^{2}\)</span> que es el que indica que también ajusta el modelo tiene la misma interpretación en las 4 predicciones y es que el modelo no ajusto para nada bien. Por parte los otros errores, el MSE es mínimo en la predicción de los 7 días, lo que indica que los errores o la diferencia entre lo observado y predicho es menor en ese horizonte de predicción.</p>
<p>Veamos que pasa con los errores al usar el Rolling.</p>
<p><strong>Errores de predicción con rolling</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d7</span><span class="o">=</span><span class="n">forecast_accuracy</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">test_df7</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">predic_7</span><span class="p">),</span> <span class="s2">&quot; 7 días&quot;</span><span class="p">)</span>
<span class="n">d14</span><span class="o">=</span><span class="n">forecast_accuracy</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">test_df14</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">predic_14</span><span class="p">),</span> <span class="s2">&quot; 14 días &quot;</span><span class="p">)</span>
<span class="n">d21</span><span class="o">=</span><span class="n">forecast_accuracy</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">test_df21</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">predic_21</span><span class="p">),</span> <span class="s2">&quot; 21 días&quot;</span><span class="p">)</span>
<span class="n">d28</span><span class="o">=</span><span class="n">forecast_accuracy</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">test_df28</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">predic_28</span><span class="p">),</span> <span class="s2">&quot; 28 días&quot;</span><span class="p">)</span>

<span class="n">errores_rolinAIC</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">d7</span><span class="p">,</span> <span class="n">d14</span><span class="p">,</span> <span class="n">d21</span><span class="p">,</span> <span class="n">d28</span><span class="p">])</span>
<span class="n">errores_rolinAIC</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MAE</th>
      <th>MSE</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7 días</th>
      <td>10.429620</td>
      <td>170.795290</td>
      <td>0.024080</td>
      <td>13.068867</td>
      <td>0.205547</td>
    </tr>
    <tr>
      <th>14 días</th>
      <td>14.335550</td>
      <td>317.838622</td>
      <td>0.032432</td>
      <td>17.828029</td>
      <td>0.646157</td>
    </tr>
    <tr>
      <th>21 días</th>
      <td>16.358713</td>
      <td>413.723698</td>
      <td>0.036754</td>
      <td>20.340199</td>
      <td>0.793520</td>
    </tr>
    <tr>
      <th>28 días</th>
      <td>13.962561</td>
      <td>315.340071</td>
      <td>0.031359</td>
      <td>17.757817</td>
      <td>0.782878</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Esta tabla de errores es mucho mas optimista, esta tabla contiene los errores obtenidos en la predicciones donde se usó el rolling, empezando por el <span class="math notranslate nohighlight">\(R^{2}\)</span> en este punto ninguno es negativo lo que da mas tranquilidad, el <span class="math notranslate nohighlight">\(R^2\)</span>  mas alto se obtuvo en la prediccion de los 21 días donde es de 79%. Por parte del MSE, se obtuvo el minimo en la predicción de los 7 días es decir que la diferencia entre lo observado y predicho es menor en ese forecast y de hecho si nos fijamos bien todos los errores son mínimos en la predicción de los 7 días.</p>
<p>Pasemos a analisar los gráficos de corelación de lo observado vs lo predicho, esta vez se harán solamente para las predicciones con rolling puesto que estas fueron las predicciones que tucieron mejor ajuste.</p>
</section>
<section id="graficos-de-correlacion-observado-vs-predicho">
<h3><strong>Gráficos de correlación: observado vs predicho</strong><a class="headerlink" href="#graficos-de-correlacion-observado-vs-predicho" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;figure.figsize&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="mi">8</span> <span class="p">,</span> <span class="mi">6</span><span class="p">)})</span>
<span class="n">fig</span> <span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span> <span class="o">=</span> <span class="mi">2</span> <span class="p">,</span> <span class="n">ncols</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># Horizonte de 7 días</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">test_df7</span><span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">]</span> <span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">predic_7</span> <span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span> <span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span> <span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test_df7</span> <span class="p">,</span> <span class="n">test_df7</span> <span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;b&#39;</span> <span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Correlación&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span> <span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Horizonte 7 días&#39;</span> <span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>

<span class="c1"># Horizonte de 14 días</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">test_df14</span><span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">]</span> <span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">predic_14</span> <span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span> <span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span> <span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test_df14</span> <span class="p">,</span> <span class="n">test_df14</span> <span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;b&#39;</span> <span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Correlación&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span> <span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Horizonte 14 días&#39;</span> <span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>

<span class="c1"># Horizonte de 21 días</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">test_df21</span><span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">]</span> <span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">predic_21</span> <span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span> <span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span> <span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span> <span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test_df21</span> <span class="p">,</span> <span class="n">test_df21</span> <span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;b&#39;</span> <span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Correlación&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span> <span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Horizonte 21 días&#39;</span> <span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>

<span class="c1"># Horizonte de 28 días</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">test_df28</span><span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">]</span> <span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">predic_28</span> <span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span> <span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span> <span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span> <span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test_df28</span> <span class="p">,</span> <span class="n">test_df28</span> <span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;b&#39;</span> <span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Correlación&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span> <span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Horizonte de 28 días&#39;</span> <span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/00a77586bd47713854630efaa1edfd31e38ec301e5cfe7535e921d849896a869.png" src="_images/00a77586bd47713854630efaa1edfd31e38ec301e5cfe7535e921d849896a869.png" />
</div>
</div>
<p>El gráfico anterior muestra como son las correlaciones entre los valores observados y predichos, lo ideal seria que en cada uno de los horizontes los puntos estuvieran sobre la linea azul, es decir, que tuvieran correlación de 1, pero como hablamos anteriormente esto no ocurre, las correlaciones mas altas estan en los días 21 y 28 que como vimos en la table de errores, estas correlaciones son de 79% y 78% respectivamente.</p>
</section>
</section>
<section id="analisis-de-los-supuestos-y-predicciones-modelo-2-bic">
<h2><strong>Análisis de los supuestos y predicciones: modelo 2 BIC</strong><a class="headerlink" href="#analisis-de-los-supuestos-y-predicciones-modelo-2-bic" title="Link to this heading">#</a></h2>
<p>Ahora veamos como se comporta el modelo dos que es el que obtuvo el menor BIC.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modelo2</span><span class="o">=</span><span class="n">smtsa</span><span class="o">.</span><span class="n">ARIMA</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;figure.figsize&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">6</span><span class="p">)})</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">();</span>
<span class="n">plot_predict</span><span class="p">(</span><span class="n">modelo2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">);</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">();</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/4251db30a298fe31e19c43e7955fb12e957d178cc784ca0a9a6e41fa21a36e6f.png" src="_images/4251db30a298fe31e19c43e7955fb12e957d178cc784ca0a9a6e41fa21a36e6f.png" />
</div>
</div>
<section id="id10">
<h3><strong>Supuestos</strong><a class="headerlink" href="#id10" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modelo2</span><span class="o">.</span><span class="n">plot_diagnostics</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/dafb56e4604ec6f852104fe90bd056c0deae0d6c6a0117e4124093c7001ca80e.png" src="_images/dafb56e4604ec6f852104fe90bd056c0deae0d6c6a0117e4124093c7001ca80e.png" />
</div>
</div>
<p>Si vemos los residuos del nuestro segundo modelo, vemos que estos de igual forma con indepentientes, es decir, que lo residuos no siguen una tendencia, lo cual es lo ideal, vemos ademas que estos siguen una distribución normal.</p>
</section>
<section id="id11">
<h3><strong>Predicciones</strong><a class="headerlink" href="#id11" title="Link to this heading">#</a></h3>
<p>A continuación pasaremos a hacer las predicciones para cada uno de los horizontes de predicción.</p>
<p>Recordemos que para cada una de las predicciones se debe separar cada uno de los conjuntos de entrenamiento y de test, este proceso ya se realizó en las predicciones del modelo anterior, por tanto en esta seccion solo pasaremos a predecir con el nuevo modelo y utilizando los conjuntos anteriormente definidos.</p>
<section id="id12">
<h4><strong>7 días</strong><a class="headerlink" href="#id12" title="Link to this heading">#</a></h4>
<section id="id13">
<h5><strong>Rolling</strong><a class="headerlink" href="#id13" title="Link to this heading">#</a></h5>
<p>Predicciones usando el rolling para los ultimos 7 días.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predic_7</span>  <span class="o">=</span> <span class="n">arima_rolling</span><span class="p">(</span><span class="n">train_df7</span><span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">test_final7</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>predicted=436.106540, expected=442.143066
predicted=442.512781, expected=444.049652
predicted=443.853300, expected=428.128326
predicted=427.555598, expected=417.647217
predicted=417.539112, expected=424.504852
predicted=425.079326, expected=425.962250
predicted=425.662099, expected=422.159119
</pre></div>
</div>
</div>
</div>
</section>
<section id="id14">
<h5><strong>Sin Rolling</strong><a class="headerlink" href="#id14" title="Link to this heading">#</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modelo2</span><span class="o">=</span><span class="n">smtsa</span><span class="o">.</span><span class="n">ARIMA</span><span class="p">(</span><span class="n">train_df7</span><span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">forecast_steps</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_df7</span><span class="p">)</span>
<span class="n">forecast_7</span> <span class="o">=</span> <span class="n">modelo2</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">forecast_steps</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">test_df7</span><span class="p">)):</span>
    <span class="n">observado</span> <span class="o">=</span> <span class="n">test_df7</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">]</span> 
    <span class="n">predicho_7</span> <span class="o">=</span> <span class="n">forecast_7</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;observado: </span><span class="si">{</span><span class="n">observado</span><span class="si">}</span><span class="s1">, predicho: </span><span class="si">{</span><span class="n">predicho_7</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>observado: 442.14306640625, predicho: 436.10653994363116
observado: 444.0496520996094, predicho: 436.2543278799304
observado: 428.1283264160156, predicho: 436.1536802884757
observado: 417.647216796875, predicho: 436.22222402701954
observado: 424.5048522949219, predicho: 436.17554388270946
observado: 425.9622497558594, predicho: 436.20733432657937
observado: 422.15911865234375, predicho: 436.18568417239965
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predicciones_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Fecha&#39;</span><span class="p">:</span> <span class="n">test_df7</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
    <span class="s1">&#39;Predicho&#39;</span><span class="p">:</span> <span class="n">forecast_7</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">test_df7</span><span class="p">)]</span>
<span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">train_df7</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">train_df7</span><span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Train&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test_df7</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">test_df7</span><span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Test (Últimos 7 días)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">predicciones_df</span><span class="p">[</span><span class="s1">&#39;Fecha&#39;</span><span class="p">],</span> <span class="n">predicciones_df</span><span class="p">[</span><span class="s1">&#39;Predicho&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Predicciones&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/688529b7a862360b327f83d28df4d8ca50bb1dd99fd03cb454b28f35ccd44a1a.png" src="_images/688529b7a862360b327f83d28df4d8ca50bb1dd99fd03cb454b28f35ccd44a1a.png" />
</div>
</div>
<p>En la gráfica anterior vemos como fueron las predicciones de los ultimos 7 días sin usar el rolling, vemos que de igual forma que con los modelos anteriores las predicciones no estan ajustando bien en el conjunto de test, veremos que este comportamiento se repite en las demas predicciones.</p>
</section>
</section>
<section id="id15">
<h4><strong>14 días</strong><a class="headerlink" href="#id15" title="Link to this heading">#</a></h4>
<section id="id16">
<h5><strong>Rolling</strong><a class="headerlink" href="#id16" title="Link to this heading">#</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predic_14</span>  <span class="o">=</span> <span class="n">arima_rolling</span><span class="p">(</span><span class="n">train_df14</span><span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">test_final14</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>predicted=466.043691, expected=453.881927
predicted=454.708970, expected=452.733978
predicted=453.114718, expected=453.143250
predicted=453.255447, expected=448.711243
predicted=448.877668, expected=442.722015
predicted=442.403026, expected=439.577698
predicted=439.698731, expected=436.323547
predicted=436.106540, expected=442.143066
predicted=442.512781, expected=444.049652
predicted=443.853300, expected=428.128326
predicted=427.555598, expected=417.647217
predicted=417.539112, expected=424.504852
predicted=425.079326, expected=425.962250
predicted=425.662099, expected=422.159119
</pre></div>
</div>
</div>
</div>
</section>
<section id="id17">
<h5><strong>Sin rolling</strong><a class="headerlink" href="#id17" title="Link to this heading">#</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modelo2</span><span class="o">=</span><span class="n">smtsa</span><span class="o">.</span><span class="n">ARIMA</span><span class="p">(</span><span class="n">train_df14</span><span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">forecast_steps</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_df14</span><span class="p">)</span>
<span class="n">forecast_14</span> <span class="o">=</span> <span class="n">modelo2</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">forecast_steps</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">test_df14</span><span class="p">)):</span>
    <span class="n">observado</span> <span class="o">=</span> <span class="n">test_df14</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">]</span> 
    <span class="n">predicho_14</span> <span class="o">=</span> <span class="n">forecast_14</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;observado: </span><span class="si">{</span><span class="n">observado</span><span class="si">}</span><span class="s1">, predicho: </span><span class="si">{</span><span class="n">predicho_14</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>observado: 453.8819274902344, predicho: 466.04369116862694
observado: 452.7339782714844, predicho: 465.599172359195
observado: 453.14324951171875, predicho: 465.91154981816754
observado: 448.71124267578125, predicho: 465.69203227514424
observado: 442.7220153808594, predicho: 465.8462942115
observado: 439.57769775390625, predicho: 465.73788945860196
observado: 436.32354736328125, predicho: 465.8140689149766
observado: 442.14306640625, predicho: 465.76053519603533
observado: 444.0496520996094, predicho: 465.798155037395
observado: 428.1283264160156, predicho: 465.77171838229395
observado: 417.647216796875, predicho: 465.79029625789553
observado: 424.5048522949219, predicho: 465.7772409957775
observado: 425.9622497558594, predicho: 465.78641534232963
observado: 422.15911865234375, predicho: 465.7799682381737
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predicciones_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Fecha&#39;</span><span class="p">:</span> <span class="n">test_df14</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
    <span class="s1">&#39;Predicho&#39;</span><span class="p">:</span> <span class="n">forecast_14</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">test_df14</span><span class="p">)]</span>
<span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">train_df14</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">train_df14</span><span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Train&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test_df14</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">test_df14</span><span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Test (Últimos 14 días)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">predicciones_df</span><span class="p">[</span><span class="s1">&#39;Fecha&#39;</span><span class="p">],</span> <span class="n">predicciones_df</span><span class="p">[</span><span class="s1">&#39;Predicho&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Predicciones&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/e478bf1764345154164ff4aa286810f9fb393d2dd34727d65cebe8788c658cba.png" src="_images/e478bf1764345154164ff4aa286810f9fb393d2dd34727d65cebe8788c658cba.png" />
</div>
</div>
</section>
</section>
<section id="id18">
<h4><strong>21 días</strong><a class="headerlink" href="#id18" title="Link to this heading">#</a></h4>
<section id="id19">
<h5><strong>Rolling</strong><a class="headerlink" href="#id19" title="Link to this heading">#</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predic_21</span>  <span class="o">=</span> <span class="n">arima_rolling</span><span class="p">(</span><span class="n">train_df21</span><span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">test_final21</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>predicted=445.373598, expected=455.908264
predicted=456.756582, expected=458.453674
predicted=457.726308, expected=459.940979
predicted=460.466867, expected=466.718781
predicted=466.233378, expected=465.401154
predicted=465.811057, expected=458.713226
predicted=458.331704, expected=465.411133
predicted=466.043691, expected=453.881927
predicted=454.708970, expected=452.733978
predicted=453.114718, expected=453.143250
predicted=453.255447, expected=448.711243
predicted=448.877668, expected=442.722015
predicted=442.403026, expected=439.577698
predicted=439.698731, expected=436.323547
predicted=436.106540, expected=442.143066
predicted=442.512781, expected=444.049652
predicted=443.853300, expected=428.128326
predicted=427.555598, expected=417.647217
predicted=417.539112, expected=424.504852
predicted=425.079326, expected=425.962250
predicted=425.662099, expected=422.159119
</pre></div>
</div>
</div>
</div>
</section>
<section id="id20">
<h5><strong>Sin rolling</strong><a class="headerlink" href="#id20" title="Link to this heading">#</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modelo2</span><span class="o">=</span><span class="n">smtsa</span><span class="o">.</span><span class="n">ARIMA</span><span class="p">(</span><span class="n">train_df21</span><span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">forecast_steps</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_df21</span><span class="p">)</span>
<span class="n">forecast_21</span> <span class="o">=</span> <span class="n">modelo2</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">forecast_steps</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">test_df21</span><span class="p">)):</span>
    <span class="n">observado</span> <span class="o">=</span> <span class="n">test_df21</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">]</span> 
    <span class="n">predicho_21</span> <span class="o">=</span> <span class="n">forecast_21</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;observado: </span><span class="si">{</span><span class="n">observado</span><span class="si">}</span><span class="s1">, predicho: </span><span class="si">{</span><span class="n">predicho_21</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>observado: 455.90826416015625, predicho: 445.3735983482845
observado: 458.45367431640625, predicho: 446.05423894749555
observado: 459.94097900390625, predicho: 445.4543603805543
observado: 466.7187805175781, predicho: 445.98305980796516
observado: 465.4011535644531, predicho: 445.5170936942401
observado: 458.7132263183594, predicho: 445.92777017294054
observado: 465.4111328125, predicho: 445.56582288709706
observado: 453.8819274902344, predicho: 445.8848229869908
observado: 452.7339782714844, predicho: 445.60367413545276
observado: 453.14324951171875, predicho: 445.8514630130973
observado: 448.71124267578125, predicho: 445.63307575115954
observado: 442.7220153808594, predicho: 445.82555007296946
observado: 439.57769775390625, predicho: 445.65591396769724
observado: 436.32354736328125, predicho: 445.8054217458847
observado: 442.14306640625, predicho: 445.67365394973854
observado: 444.0496520996094, predicho: 445.7897867176234
observado: 428.1283264160156, predicho: 445.68743378943424
observado: 417.647216796875, predicho: 445.7776419373988
observado: 424.5048522949219, predicho: 445.6981375196633
observado: 425.9622497558594, predicho: 445.76820826806113
observado: 422.15911865234375, predicho: 445.70645182834517
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predicciones_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Fecha&#39;</span><span class="p">:</span> <span class="n">test_df21</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
    <span class="s1">&#39;Predicho&#39;</span><span class="p">:</span> <span class="n">forecast_21</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">test_df21</span><span class="p">)]</span>
<span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">train_df21</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">train_df21</span><span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Train&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test_df21</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">test_df21</span><span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Test (Últimos 21 días)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">predicciones_df</span><span class="p">[</span><span class="s1">&#39;Fecha&#39;</span><span class="p">],</span> <span class="n">predicciones_df</span><span class="p">[</span><span class="s1">&#39;Predicho&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Predicciones&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/26db12929260c39a7dd5b4a868cd2457edfaba09aa7f3b7564c15171e96db2ae.png" src="_images/26db12929260c39a7dd5b4a868cd2457edfaba09aa7f3b7564c15171e96db2ae.png" />
</div>
</div>
</section>
</section>
<section id="id21">
<h4><strong>28 días</strong><a class="headerlink" href="#id21" title="Link to this heading">#</a></h4>
<section id="id22">
<h5><strong>Rolling</strong><a class="headerlink" href="#id22" title="Link to this heading">#</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predic_28</span>  <span class="o">=</span> <span class="n">arima_rolling</span><span class="p">(</span><span class="n">train_df28</span><span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">test_final28</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>predicted=446.037890, expected=444.898132
predicted=444.396204, expected=448.970764
predicted=449.625665, expected=446.864594
predicted=446.168217, expected=450.138672
predicted=450.903757, expected=451.346497
predicted=450.680234, expected=452.035248
predicted=452.675523, expected=446.145874
predicted=445.373598, expected=455.908264
predicted=456.756582, expected=458.453674
predicted=457.726308, expected=459.940979
predicted=460.466867, expected=466.718781
predicted=466.233378, expected=465.401154
predicted=465.811057, expected=458.713226
predicted=458.331704, expected=465.411133
predicted=466.043691, expected=453.881927
predicted=454.708970, expected=452.733978
predicted=453.114718, expected=453.143250
predicted=453.255447, expected=448.711243
predicted=448.877668, expected=442.722015
predicted=442.403026, expected=439.577698
predicted=439.698731, expected=436.323547
predicted=436.106540, expected=442.143066
predicted=442.512781, expected=444.049652
predicted=443.853300, expected=428.128326
predicted=427.555598, expected=417.647217
predicted=417.539112, expected=424.504852
predicted=425.079326, expected=425.962250
predicted=425.662099, expected=422.159119
</pre></div>
</div>
</div>
</div>
</section>
<section id="id23">
<h5><strong>Sin rolling</strong><a class="headerlink" href="#id23" title="Link to this heading">#</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">modelo2</span><span class="o">=</span><span class="n">smtsa</span><span class="o">.</span><span class="n">ARIMA</span><span class="p">(</span><span class="n">train_df28</span><span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">order</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">forecast_steps</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">test_df28</span><span class="p">)</span>
<span class="n">forecast_28</span> <span class="o">=</span> <span class="n">modelo2</span><span class="o">.</span><span class="n">forecast</span><span class="p">(</span><span class="n">steps</span><span class="o">=</span><span class="n">forecast_steps</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">test_df28</span><span class="p">)):</span>
    <span class="n">observado</span> <span class="o">=</span> <span class="n">test_df28</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">]</span> 
    <span class="n">predicho_28</span> <span class="o">=</span> <span class="n">forecast_28</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;observado: </span><span class="si">{</span><span class="n">observado</span><span class="si">}</span><span class="s1">, predicho: </span><span class="si">{</span><span class="n">predicho_28</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>observado: 444.89813232421875, predicho: 446.03788973837635
observado: 448.97076416015625, predicho: 445.5893620830481
observado: 446.8645935058594, predicho: 445.99096684289754
observado: 450.138671875, predicho: 445.63137612152786
observado: 451.34649658203125, predicho: 445.95334811942854
observado: 452.0352478027344, predicho: 445.66505934757896
observado: 446.1458740234375, predicho: 445.92318867719905
observado: 455.90826416015625, predicho: 445.6920636480048
observado: 458.45367431640625, predicho: 445.8990094421874
observado: 459.94097900390625, predicho: 445.71371336292174
observado: 466.7187805175781, predicho: 445.8796246206346
observado: 465.4011535644531, predicho: 445.7310702338124
observado: 458.7132263183594, predicho: 445.86408354555715
observado: 465.4111328125, predicho: 445.7449854732634
observado: 453.8819274902344, predicho: 445.8516240543049
observado: 452.7339782714844, predicho: 445.75614150998217
observado: 453.14324951171875, predicho: 445.84163511071563
observado: 448.71124267578125, predicho: 445.7650854563446
observado: 442.7220153808594, predicho: 445.8336268387879
observado: 439.57769775390625, predicho: 445.7722559397834
observado: 436.32354736328125, predicho: 445.8272064982688
observado: 442.14306640625, predicho: 445.7780046138767
observado: 444.0496520996094, predicho: 445.8220592239564
observado: 428.1283264160156, predicho: 445.78261340408073
observado: 417.647216796875, predicho: 445.8179325841358
observado: 424.5048522949219, predicho: 445.7863083338681
observado: 425.9622497558594, predicho: 445.8146242008683
observado: 422.15911865234375, predicho: 445.78927060933063
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">predicciones_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s1">&#39;Fecha&#39;</span><span class="p">:</span> <span class="n">test_df28</span><span class="o">.</span><span class="n">index</span><span class="p">,</span>
    <span class="s1">&#39;Predicho&#39;</span><span class="p">:</span> <span class="n">forecast_28</span><span class="p">[:</span><span class="nb">len</span><span class="p">(</span><span class="n">test_df28</span><span class="p">)]</span>
<span class="p">})</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">train_df28</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">train_df28</span><span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Train&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test_df28</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">test_df28</span><span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Test (Últimos 28 días)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">predicciones_df</span><span class="p">[</span><span class="s1">&#39;Fecha&#39;</span><span class="p">],</span> <span class="n">predicciones_df</span><span class="p">[</span><span class="s1">&#39;Predicho&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Predicciones&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/cdff33a26d553a22d061d615c17389c1de5029c73e1d0c6cd1d07747152d74fc.png" src="_images/cdff33a26d553a22d061d615c17389c1de5029c73e1d0c6cd1d07747152d74fc.png" />
</div>
</div>
</section>
</section>
</section>
<section id="id24">
<h3><strong>Gráficas de predicción con rolling</strong><a class="headerlink" href="#id24" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

<span class="c1"># Gráfica para horizonte de 7 días</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_train7</span><span class="p">[</span><span class="o">-</span><span class="mi">50</span><span class="p">:],</span> <span class="n">y</span><span class="o">=</span><span class="n">train_df7</span><span class="p">[</span><span class="o">-</span><span class="mi">50</span><span class="p">:][</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Train&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_test7</span><span class="p">[:</span><span class="mi">7</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">test_final7</span><span class="p">[:</span><span class="mi">7</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Test&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_test7</span><span class="p">[:</span><span class="mi">7</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">predic_7</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Forecast&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Predicción de 7 días&quot;</span><span class="p">)</span>

<span class="c1"># Gráfica para horizonte de 14 días</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_train14</span><span class="p">[</span><span class="o">-</span><span class="mi">50</span><span class="p">:],</span> <span class="n">y</span><span class="o">=</span><span class="n">train_df14</span><span class="p">[</span><span class="o">-</span><span class="mi">50</span><span class="p">:][</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Train&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_test14</span><span class="p">[:</span><span class="mi">14</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">test_final14</span><span class="p">[:</span><span class="mi">14</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Test&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_test14</span><span class="p">[:</span><span class="mi">14</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">predic_14</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Forecast&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Predicción de 14 días&quot;</span><span class="p">)</span>

<span class="c1"># Gráfica para horizonte de 21 días</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_train21</span><span class="p">[</span><span class="o">-</span><span class="mi">50</span><span class="p">:],</span> <span class="n">y</span><span class="o">=</span><span class="n">train_df21</span><span class="p">[</span><span class="o">-</span><span class="mi">50</span><span class="p">:][</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Train&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_test21</span><span class="p">[:</span><span class="mi">21</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">test_final21</span><span class="p">[:</span><span class="mi">21</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Test&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_test21</span><span class="p">[:</span><span class="mi">21</span><span class="p">],</span> <span class="n">y</span><span class="o">=</span><span class="n">predic_21</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Forecast&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Predicción de 21 días&quot;</span><span class="p">)</span>

<span class="c1"># Gráfica para horizonte de 28 días</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_train28</span><span class="p">[</span><span class="o">-</span><span class="mi">50</span><span class="p">:],</span> <span class="n">y</span><span class="o">=</span><span class="n">train_df28</span><span class="p">[</span><span class="o">-</span><span class="mi">50</span><span class="p">:][</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">],</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Train&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_test28</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">test_final28</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Test&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">sns</span><span class="o">.</span><span class="n">lineplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">dates_test28</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">predic_28</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Forecast&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Predicción de 28 días&quot;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Predicciones usando rolling ARIMA (1,1,1)&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>

<span class="c1"># Ajustar la presentación</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">rect</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/cd0dbfc7052001b15d370b289a8ebcdcf58de66cbd6bef7aef995182017bcde8.png" src="_images/cd0dbfc7052001b15d370b289a8ebcdcf58de66cbd6bef7aef995182017bcde8.png" />
</div>
</div>
<p>La gráfica anterior muestra las predicciones del modelo en cada uno de los horizontes de predicción en los respectivos conjuntos de test, se nota un buen ajuste y esto se comprueba en las tablas de errores.</p>
</section>
<section id="id25">
<h3><strong>Tablas de errores</strong><a class="headerlink" href="#id25" title="Link to this heading">#</a></h3>
<p><strong>Errores de predicción sin rolling</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d7</span><span class="o">=</span><span class="n">forecast_accuracy</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">test_df7</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">forecast_7</span><span class="p">),</span> <span class="s2">&quot; 7 días&quot;</span><span class="p">)</span>
<span class="n">d14</span><span class="o">=</span><span class="n">forecast_accuracy</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">test_df14</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">forecast_14</span><span class="p">),</span> <span class="s2">&quot; 14 días &quot;</span><span class="p">)</span>
<span class="n">d21</span><span class="o">=</span><span class="n">forecast_accuracy</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">test_df21</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">forecast_21</span><span class="p">),</span> <span class="s2">&quot; 21 días&quot;</span><span class="p">)</span>
<span class="n">d28</span><span class="o">=</span><span class="n">forecast_accuracy</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">test_df28</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">forecast_28</span><span class="p">),</span> <span class="s2">&quot; 28 días&quot;</span><span class="p">)</span>

<span class="n">errores_sin</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">d7</span><span class="p">,</span> <span class="n">d14</span><span class="p">,</span> <span class="n">d21</span><span class="p">,</span> <span class="n">d28</span><span class="p">])</span>
<span class="n">errores_sin</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MAE</th>
      <th>MSE</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7 días</th>
      <td>10.907198</td>
      <td>134.817749</td>
      <td>0.025006</td>
      <td>11.611105</td>
      <td>-0.561903</td>
    </tr>
    <tr>
      <th>14 días</th>
      <td>27.815778</td>
      <td>915.467951</td>
      <td>0.059717</td>
      <td>30.256701</td>
      <td>-5.456089</td>
    </tr>
    <tr>
      <th>21 días</th>
      <td>12.860680</td>
      <td>222.722681</td>
      <td>0.028853</td>
      <td>14.923896</td>
      <td>-0.001240</td>
    </tr>
    <tr>
      <th>28 días</th>
      <td>10.413227</td>
      <td>170.609261</td>
      <td>0.023358</td>
      <td>13.061748</td>
      <td>-0.004023</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Como era de esperarse el ajuste del modelo al hacer las predicciones sin usar Rolling no es adecuado, puesto que el <span class="math notranslate nohighlight">\(R^2\)</span> da en todos negativos, lo cual es preocupante al momento de evaluar los modelos ya que la correlación debería ser positiva.</p>
<p><strong>Errores de predicción con rolling</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">d7</span><span class="o">=</span><span class="n">forecast_accuracy</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">test_df7</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">predic_7</span><span class="p">),</span> <span class="s2">&quot; 7 días&quot;</span><span class="p">)</span>
<span class="n">d14</span><span class="o">=</span><span class="n">forecast_accuracy</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">test_df14</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">predic_14</span><span class="p">),</span> <span class="s2">&quot; 14 días &quot;</span><span class="p">)</span>
<span class="n">d21</span><span class="o">=</span><span class="n">forecast_accuracy</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">test_df21</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">predic_21</span><span class="p">),</span> <span class="s2">&quot; 21 días&quot;</span><span class="p">)</span>
<span class="n">d28</span><span class="o">=</span><span class="n">forecast_accuracy</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">test_df28</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">predic_28</span><span class="p">),</span> <span class="s2">&quot; 28 días&quot;</span><span class="p">)</span>

<span class="n">errores_rolinBIC</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">d7</span><span class="p">,</span> <span class="n">d14</span><span class="p">,</span> <span class="n">d21</span><span class="p">,</span> <span class="n">d28</span><span class="p">])</span>
<span class="n">errores_rolinBIC</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MAE</th>
      <th>MSE</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7 días</th>
      <td>10.399537</td>
      <td>173.115101</td>
      <td>0.024035</td>
      <td>13.157321</td>
      <td>0.262791</td>
    </tr>
    <tr>
      <th>14 días</th>
      <td>14.472146</td>
      <td>325.634952</td>
      <td>0.032747</td>
      <td>18.045358</td>
      <td>0.659565</td>
    </tr>
    <tr>
      <th>21 días</th>
      <td>16.490149</td>
      <td>421.877817</td>
      <td>0.037054</td>
      <td>20.539664</td>
      <td>0.800148</td>
    </tr>
    <tr>
      <th>28 días</th>
      <td>14.101503</td>
      <td>321.774228</td>
      <td>0.031674</td>
      <td>17.938066</td>
      <td>0.784798</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Vemos que al momento de usar rolling el ajuste de las predicciones  mejora en gran manera, esto se puede ver al analizar los <span class="math notranslate nohighlight">\(R^2\)</span>, el mejor se obtuvo en el horizonte de 21 dias con un 80% de ajuste, a medida que se expande el horizonte de predicción los errores van aumentando poco a poco, es por esto que los errores mas pequeños al predecir los ultimos 7 días.</p>
</section>
<section id="id26">
<h3><strong>Gráficos de correlación: observado vs predicho</strong><a class="headerlink" href="#id26" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;figure.figsize&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="mi">8</span> <span class="p">,</span> <span class="mi">6</span><span class="p">)})</span>
<span class="n">fig</span> <span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">nrows</span> <span class="o">=</span> <span class="mi">2</span> <span class="p">,</span> <span class="n">ncols</span> <span class="o">=</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># Horizonte de 7 días</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">test_df7</span><span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">]</span> <span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">predic_7</span> <span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span> <span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span> <span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test_df7</span> <span class="p">,</span> <span class="n">test_df7</span> <span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;b&#39;</span> <span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Correlación&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span> <span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Horizonte 7 días&#39;</span> <span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>

<span class="c1"># Horizonte de 14 días</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">test_df14</span><span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">]</span> <span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">predic_14</span> <span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">0</span> <span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span> <span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test_df14</span> <span class="p">,</span> <span class="n">test_df14</span> <span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;b&#39;</span> <span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Correlación&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span> <span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Horizonte 14 días&#39;</span> <span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>

<span class="c1"># Horizonte de 21 días</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">test_df21</span><span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">]</span> <span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">predic_21</span> <span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span> <span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span> <span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span> <span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test_df21</span> <span class="p">,</span> <span class="n">test_df21</span> <span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;b&#39;</span> <span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Correlación&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span> <span class="p">,</span> <span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Horizonte 21 días&#39;</span> <span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>

<span class="c1"># Horizonte de 28 días</span>
<span class="n">sns</span><span class="o">.</span><span class="n">scatterplot</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">test_df28</span><span class="p">[</span><span class="s1">&#39;Adj Close&#39;</span><span class="p">]</span> <span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">predic_28</span> <span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="mi">1</span> <span class="p">,</span> <span class="mi">1</span><span class="p">]</span> <span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span> <span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span> <span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">test_df28</span> <span class="p">,</span> <span class="n">test_df28</span> <span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;b&#39;</span> <span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;Correlación&#39;</span><span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span> <span class="p">,</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Horizonte de 28 días&#39;</span> <span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="mi">12</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/5bef3d72fda92b4414eaa9c86c50d69baafc7b625ac72428b93b03ede2758ec6.png" src="_images/5bef3d72fda92b4414eaa9c86c50d69baafc7b625ac72428b93b03ede2758ec6.png" />
</div>
</div>
</section>
</section>
<section id="comparacion-entre-modelo-1-y-modelo-2-mediante-los-errores">
<h2><strong>Comparación entre modelo 1 y modelo 2 mediante los errores</strong><a class="headerlink" href="#comparacion-entre-modelo-1-y-modelo-2-mediante-los-errores" title="Link to this heading">#</a></h2>
<p><strong>Errores de Rolling en el modelo 1: mejor AIC</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">errores_rolinAIC</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MAE</th>
      <th>MSE</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7 días</th>
      <td>10.429620</td>
      <td>170.795290</td>
      <td>0.024080</td>
      <td>13.068867</td>
      <td>0.205547</td>
    </tr>
    <tr>
      <th>14 días</th>
      <td>14.335550</td>
      <td>317.838622</td>
      <td>0.032432</td>
      <td>17.828029</td>
      <td>0.646157</td>
    </tr>
    <tr>
      <th>21 días</th>
      <td>16.358713</td>
      <td>413.723698</td>
      <td>0.036754</td>
      <td>20.340199</td>
      <td>0.793520</td>
    </tr>
    <tr>
      <th>28 días</th>
      <td>13.962561</td>
      <td>315.340071</td>
      <td>0.031359</td>
      <td>17.757817</td>
      <td>0.782878</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>Errores de Rolling en el modelo 2: mejor BIC</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">errores_rolinBIC</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MAE</th>
      <th>MSE</th>
      <th>MAPE</th>
      <th>RMSE</th>
      <th>R2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>7 días</th>
      <td>10.399537</td>
      <td>173.115101</td>
      <td>0.024035</td>
      <td>13.157321</td>
      <td>0.262791</td>
    </tr>
    <tr>
      <th>14 días</th>
      <td>14.472146</td>
      <td>325.634952</td>
      <td>0.032747</td>
      <td>18.045358</td>
      <td>0.659565</td>
    </tr>
    <tr>
      <th>21 días</th>
      <td>16.490149</td>
      <td>421.877817</td>
      <td>0.037054</td>
      <td>20.539664</td>
      <td>0.800148</td>
    </tr>
    <tr>
      <th>28 días</th>
      <td>14.101503</td>
      <td>321.774228</td>
      <td>0.031674</td>
      <td>17.938066</td>
      <td>0.784798</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p><strong>Conclusiones:</strong> Si comparamos en primer lugar el <span class="math notranslate nohighlight">\(r^2\)</span> vemos que se obtienen mejores scores en el modelo de mejor BIC, es decir el modelo ARIMA con parámetros (1,1,1), es decir que este modelo ajusta mejor la variabilidad de los datos. Si analizamos los demás errores vemos que también son menores en este modelo (1,1,1) si nos centramos en este modelo y analizamos el MAE en cada una de las predicciones el menor se encuentra en la predicción de 7 días, es decir que a medida que aumentamos la ventana de predicción los errores pueden aumentar y esto mismo sucede con los demás errores.</p>
<p>Por tanto, si tenemos en cuenta los errores para determinar que modelo es mejor, diremos que los mejores parámetros son (1,1,1) y estos parámetros recordemos que lo encontramos al tomar como referencia el criterio BIC.</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="intro.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Instrucciones</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comportamiento-de-la-serie-de-tiempo"><strong>Comportamiento de la serie de tiempo:</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#busqueda-de-los-mejores-parametros-teniendo-en-cuenta-los-criterios-aic-bic-y-hqic"><strong>Busqueda de los mejores parametros teniendo en cuenta los criterios AIC, BIC y HQIC</strong></a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-de-los-supuestos-y-predicciones-modelo-1-aic"><strong>Análisis de los supuestos y predicciones: modelo 1 AIC</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#supuestos"><strong>Supuestos</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#predicciones"><strong>Predicciones</strong>.</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#dias"><strong>7 días</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#rolling"><strong>Rolling</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#sin-rolling"><strong>Sin rolling</strong></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id1"><strong>14 días</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id2"><strong>Rolling</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id3"><strong>Sin rolling</strong></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id4"><strong>21 días</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id5"><strong>Rolling</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id6"><strong>Sin Rolling</strong></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id7"><strong>28 días</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id8"><strong>Rolling</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id9"><strong>Sin Rolling</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#graficas-de-prediccion-con-rolling"><strong>Gráficas de predicción con rolling</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tablas-de-errores"><strong>Tablas de errores</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#graficos-de-correlacion-observado-vs-predicho"><strong>Gráficos de correlación: observado vs predicho</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-de-los-supuestos-y-predicciones-modelo-2-bic"><strong>Análisis de los supuestos y predicciones: modelo 2 BIC</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id10"><strong>Supuestos</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id11"><strong>Predicciones</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id12"><strong>7 días</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id13"><strong>Rolling</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id14"><strong>Sin Rolling</strong></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id15"><strong>14 días</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id16"><strong>Rolling</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id17"><strong>Sin rolling</strong></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id18"><strong>21 días</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id19"><strong>Rolling</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id20"><strong>Sin rolling</strong></a></li>
</ul>
</li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id21"><strong>28 días</strong></a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id22"><strong>Rolling</strong></a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id23"><strong>Sin rolling</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id24"><strong>Gráficas de predicción con rolling</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id25"><strong>Tablas de errores</strong></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id26"><strong>Gráficos de correlación: observado vs predicho</strong></a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comparacion-entre-modelo-1-y-modelo-2-mediante-los-errores"><strong>Comparación entre modelo 1 y modelo 2 mediante los errores</strong></a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Nicoll Fontalvo AVila
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>